Specific changes in the files:

File: gin_list_dlabels.m

Addition of line:

%In case the file is used in batch mode (from toolbox)
if length(varargin) > 2 ,	hReg = [];  atlas = char(varargin{3}); pr= varargin{4}; end

Addition: (to clear results window)

spm_figure('Clear','Graphics');

Changing of the condition to accomodate more inputs:


%-get number and separation for maxima to be reported
%-----------------------------------------------------------------------
if length(varargin) > 4(changed from 3)

	Num    = varargin{5(4)};		% number of maxima per cluster
	Dis    = varargin{6(5)};		% distance among clusters (mm)
else
	Num    = 3;
	Dis    = 8;
end
if length(varargin) > 6(5)

	Title  = varargin{7(6)};
else
	Title  = ['volume summary',...
			' (labels and distances for entire volume)'];
end






File: gin_list_plabels.m

Addition of line:

%In case the file is used in batch mode (from toolbox)
if length(varargin) ==5 ,	hReg = [];  atlas = char(varargin{3}); ext = varargin{4}; pr = varargin{5};  end

Addition to accept radius as input in batch mode:

% Spherical Region : Default Value is 10 mm
if exist('ext')
    Rd=ext;
else
Rd 	= spm_input('local maximum radius (mm)',4,'r',10,1,[0,Inf]);
end


Addition: (to clear results window)

spm_figure('Clear','Graphics');


Changing of the condition to accomodate more inputs:

if length(varargin) > 5(3)

 	Num    = varargin{6(4)};		% number of maxima per cluster
	Dis    = varargin{7(5)};		% distance among clusters (mm)
else
	Num    = 3;
	Dis    = 8;
end
if length(varargin) > 7(5)

	Title  = varargin{8(6)};
else
	Title = ['volume summary',...
			' (labels and percentages for the entire volume)'];
end




File: gin_clusters_plabels.m

Addition of line:

%In case the file is used in batch mode (from toolbox)
if length(varargin) ==4 ,	hReg = [];  atlas = char(varargin{3}); pr= varargin{4}; end



Addition: (to clear results window)

spm_figure('Clear','Graphics');


Changing of the condition to accomodate more inputs:

if length(varargin) > 4(3)

	Num    = varargin{5(4)};		% number of maxima per cluster
	Dis    = varargin{6(5)};		% distance among clusters (mm)
else
	Num    = 3;
	Dis    = 8;
end
if length(varargin) > 6(5)
    
	Title  = varargin{7(6)};
else
	Title  = ['volume summary',...
			' (labels and percentages per cluster)'];
end




Common Modifications in files gin_list_dlabels.m,gin_list_plabels.m,gin_clusters_plabels.m :

Addition of condition (to accept atlas in batch mode):

if exist('atlas')
       MNI=atlas; 
    else
        MNI=spm_select(1,'image','Select an labelised atlas');
    end

Addition to automatially print AAL results to file:

% for printing the results in batch mode
if spm_figure('#page',Fgraph)==1
if exist('pr')
    if pr == 1
    spm_figure('Print');
    end
end
end

%-Number and register last page (if paginated)
%-Changed to use Fgraph for numbering
%-----------------------------------------------------------------------
if spm_figure('#page',Fgraph)>1
	h = text(0.5,-5*dy,sprintf('Page %d/%d',spm_figure('#page',Fgraph)*[1,1]),...
		'FontName',PF.helvetica,'FontSize',FS(8),'FontAngle','Italic');
	spm_figure('NewPage',[hPage,h])
    % for printing the results in batch mode
    if exist('pr')
    if pr == 1
    spm_figure('Print');
    end
end
end

